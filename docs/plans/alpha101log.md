# Alpha101 모델 문서

Alpha101 시스템의 구조, 알파 분석, 백테스트 결과를 기록합니다.

---

## 0. Alpha101의 본질: 규칙 기반 필터 (NOT 머신러닝)

```
┌─────────────────────────────────────────────────────────────────┐
│                     Alpha101 = 규칙 기반 필터                    │
│                     (Rule-based Factor, NOT ML)                 │
└─────────────────────────────────────────────────────────────────┘

        ❌ 학습 (Learning)         ✅ 계산 (Calculation)
        ─────────────────         ─────────────────────
        - 가중치 최적화 없음        - 고정된 수학 공식
        - 역전파 없음              - 최근 3~20일 데이터 사용
        - 파라미터 업데이트 없음    - 매일 새로 계산
```

### Alpha101 vs 딥러닝 비교

| 항목 | Alpha101 | 딥러닝 모델 |
|------|----------|-------------|
| **학습** | ❌ 없음 | ✅ 있음 |
| **파라미터** | 고정 (3일, 5일, 12일 등) | 학습으로 최적화 |
| **입력** | 최근 N일 OHLCV | 과거 전체 데이터 |
| **출력** | 종목별 점수 | 예측 확률 |
| **해석** | 쉬움 (공식 명확) | 어려움 (블랙박스) |

### alpha_094 예시

```python
# 학습 없이 매일 이렇게 계산:
score = -1 * rank(vwap - ts_min(vwap, 12)) ** ts_rank(corr(...), 3)

# 그냥 "12일 저점 근처 + 최근 3일 상관관계" 조건 체크
# → 조건 만족 종목 = 높은 점수 → 매수
```

### 결론

```
Alpha101 = "최근 N일 데이터로 특정 조건 만족 종목 선정"
         = Quantitative Filter (퀀트 필터)
         = 학습 없는 규칙 기반 전략
```

| 장점 | 단점 |
|------|------|
| 해석 가능 | 시장 변화에 적응 못함 |
| 계산 빠름 | 파라미터 수동 조정 필요 |
| 과적합 위험 낮음 | 복잡한 패턴 학습 불가 |

---

## 1. 전체 아키텍처

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         Alpha101 Trading System                         │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                          1. 데이터 수집 (Raw Data)                       │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌────────────┐ │
│   │    Open     │   │    High     │   │    Low      │   │   Close    │ │
│   └─────────────┘   └─────────────┘   └─────────────┘   └────────────┘ │
│                                                                         │
│   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐                  │
│   │   Volume    │   │    VWAP     │   │   Returns   │                  │
│   └─────────────┘   └─────────────┘   └─────────────┘                  │
│                                                                         │
│                    데이터 형태: (날짜 × 종목) 패널 데이터                   │
│                    예: 2,874일 × 4,226종목                               │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                       2. 연산자 (Operators)                              │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─ 횡단면 연산 (Cross-Sectional) ─┐   ┌─ 시계열 연산 (Time-Series) ─┐  │
│   │                                │   │                              │  │
│   │  rank()    : 종목 간 순위      │   │  ts_sum()   : 기간 합계      │  │
│   │  scale()   : 정규화            │   │  ts_max()   : 기간 최대값    │  │
│   │  correlation(): 상관계수       │   │  ts_min()   : 기간 최소값    │  │
│   │  covariance() : 공분산         │   │  ts_rank()  : 기간 내 순위   │  │
│   │                                │   │  ts_argmax(): 최대값 위치    │  │
│   └────────────────────────────────┘   │  delay()    : 과거값         │  │
│                                        │  delta()    : 변화량         │  │
│   ┌─ 수학 연산 ─────────────────────┐  │  stddev()   : 표준편차       │  │
│   │                                │   │  sma()      : 이동평균       │  │
│   │  log(), abs(), sign()          │   │  decay_linear(): 가중평균    │  │
│   │  max(), min(), signedpower()   │   │                              │  │
│   └────────────────────────────────┘   └──────────────────────────────┘  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                    3. 알파 계산 (Alpha Formulas)                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  alpha_094 (최고 성과)                                          │   │
│   │  ────────────────────────────────────────────────────────────── │   │
│   │  -1 * rank(vwap - ts_min(vwap, 12)) ** ts_rank(corr(...), 3)   │   │
│   │                                                                 │   │
│   │  해석: VWAP이 12일 저점 근처 → 저평가 신호 → 매수              │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  alpha_044 (IC 최고)                                            │   │
│   │  ────────────────────────────────────────────────────────────── │   │
│   │  -1 * correlation(high, rank(volume), 5)                        │   │
│   │                                                                 │   │
│   │  해석: 고가↑ + 거래량↓ → 추가 상승 여력                        │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  alpha_016                                                      │   │
│   │  ────────────────────────────────────────────────────────────── │   │
│   │  -1 * rank(covariance(rank(high), rank(volume), 5))            │   │
│   │                                                                 │   │
│   │  해석: 고가-거래량 공분산 낮음 → 세력 매집 신호                │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│                         ... (총 101개 알파) ...                         │
│                                                                         │
│   출력: 각 알파별 (날짜 × 종목) 신호값 DataFrame                        │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                      4. 신호 결합 (Signal Combination)                   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   방법 1: 단일 알파 사용                                                 │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  signal = alpha_094                                             │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   방법 2: 다중 알파 평균                                                 │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  signal = (alpha_044 + alpha_016 + alpha_026) / 3               │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   방법 3: IC 가중 평균                                                   │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  signal = Σ (alpha_i × IC_i) / Σ IC_i                          │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                     5. 포트폴리오 구성 (Portfolio)                       │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│                        매일 종목 순위 정렬                               │
│                              │                                          │
│           ┌──────────────────┼──────────────────┐                       │
│           ▼                  ▼                  ▼                       │
│   ┌───────────────┐  ┌───────────────┐  ┌───────────────┐              │
│   │   Top 10%     │  │   Middle 80%  │  │  Bottom 10%   │              │
│   │   (LONG)      │  │   (무시)      │  │   (SHORT)     │              │
│   │               │  │               │  │               │              │
│   │  ~420종목     │  │  ~3,400종목   │  │  ~420종목     │              │
│   │  동일 가중    │  │               │  │  동일 가중    │              │
│   └───────────────┘  └───────────────┘  └───────────────┘              │
│                                                                         │
│   Long-Short Return = (Long 수익률 - Short 수익률) / 2                  │
│   Long-Only Return  = Long 수익률                                       │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                        6. 성과 측정 (Evaluation)                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─ IC (Information Coefficient) ─┐   ┌─ 백테스트 지표 ─────────────┐  │
│   │                                │   │                              │  │
│   │  • 알파 신호 vs 미래 수익률    │   │  • Total Return (총 수익률)  │  │
│   │  • Spearman 상관계수           │   │  • Sharpe Ratio (위험조정)   │  │
│   │  • 일별 계산 후 평균           │   │  • Max Drawdown (최대 손실)  │  │
│   │                                │   │  • Win Rate (승률)           │  │
│   │  IC = 0.05 → 강한 신호        │   │  • Profit Factor (손익비)    │  │
│   │                                │   │                              │  │
│   └────────────────────────────────┘   └──────────────────────────────┘  │
│                                                                         │
│   ⚠️ 주의: IC ≠ 백테스트 성과                                           │
│   - IC: 전체 종목 평균 예측력                                           │
│   - 백테스트: 극단 종목의 실제 수익                                     │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 2. 데이터 흐름

```
  ┌──────────┐     ┌──────────┐     ┌──────────┐     ┌──────────┐
  │ 키움 API │ ──▶ │ SQLite   │ ──▶ │ Alpha101 │ ──▶ │ 백테스트 │
  │ (OHLCV)  │     │ (저장)   │     │ (계산)   │     │ (평가)   │
  └──────────┘     └──────────┘     └──────────┘     └──────────┘
       │                │                │                │
       ▼                ▼                ▼                ▼
   7,244,592건     2,874일 ×       101개 알파      Sharpe 2.68
   가격 데이터     4,226종목       parquet 저장    (alpha_094)
```

---

## 3. 파일 구조

```
lasps/data/processors/alpha101/
├── __init__.py           # 모듈 초기화
├── operators.py          # 22개 연산자 (rank, ts_sum, correlation 등)
├── alpha_base.py         # MarketData, AlphaBase 클래스
├── simple_alphas.py      # 82개 Simple Alpha (섹터 정보 불필요)
├── industry_alphas.py    # 19개 Industry Alpha (섹터 중립화)
└── calculator.py         # Alpha101Calculator (메인 클래스)

scripts/
├── compute_alpha101_v2.py    # 알파 계산 스크립트 (Numba 최적화)
├── train_alpha101_model.py   # IC 계산 + 모델 학습
└── backtest_alpha101.py      # 백테스트 스크립트

data/alpha101/
├── alpha_001.parquet     # 각 알파별 (날짜 × 종목) 신호값
├── alpha_002.parquet
├── ...
└── alpha_101.parquet
```

---

## 4. alpha_094 상세 분석 (최고 성과)

```
공식: -1 * rank(vwap - ts_min(vwap, 12)) ** ts_rank(correlation(...), 3)

┌─────────────────────────────────────────────────────────────────────┐
│                         alpha_094 분해                              │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│   1. vwap - ts_min(vwap, 12)                                       │
│      └── 현재 VWAP과 12일 최저 VWAP의 차이                         │
│      └── 값이 작으면 = 12일 저점 근처 (저평가)                     │
│                                                                     │
│   2. rank(...)                                                      │
│      └── 전 종목 중 순위 (0~1)                                     │
│      └── rank 낮음 = 저점 근처 종목                                │
│                                                                     │
│   3. -1 * rank(...) ** ts_rank(...)                                │
│      └── 음수 변환 + 지수 조정                                     │
│      └── 최종: 저점 근처 종목에 높은 점수                          │
│                                                                     │
│   ═══════════════════════════════════════════════════════════════  │
│   해석: "VWAP 기준 저평가 종목 매수" = 평균회귀 전략               │
│   ═══════════════════════════════════════════════════════════════  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 5. 유의미한 14개 알파 정리

● 14개 유의미한 Alpha101 정리
  ┌──────┬───────────┬─────────┬───────┬───────┬───────────────────────────────────────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────────────────────────┐
  │ Rank │   Alpha   │ Test IC │ IC_IR │ Hit%  │                                           공식                                            │                                    의미                                    │
  ├──────┼───────────┼─────────┼───────┼───────┼───────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────┤
  │ 1    │ alpha_042 │ -0.0625 │ -0.60 │ 25.4% │ rank(vwap - close) / rank(vwap + close)                                                   │ VWAP 이탈: 종가가 VWAP보다 높으면 과매수 → 하락 예측 (역방향)              │
  ├──────┼───────────┼─────────┼───────┼───────┼───────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────┤
  │ 2    │ alpha_016 │ +0.0577 │ +0.81 │ 78.4% │ -1 * rank(covariance(rank(high), rank(volume), 5))                                        │ 고가-거래량 공분산: 고가와 거래량이 동조하지 않으면 상승                   │
  ├──────┼───────────┼─────────┼───────┼───────┼───────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────┤
  │ 3    │ alpha_040 │ +0.0567 │ +0.57 │ 71.4% │ -1 * rank(stddev(high, 10)) * corr(high, volume, 10)                                      │ 변동성 × 거래량 상관: 고가 변동성이 낮고 거래량과 음의 상관이면 상승       │
  ├──────┼───────────┼─────────┼───────┼───────┼───────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────┤
  │ 4    │ alpha_044 │ +0.0561 │ +0.89 │ 82.2% │ -1 * correlation(high, rank(volume), 5)                                                   │ 고가-거래량 비동조: 고가 상승 시 거래량 감소하면 추가 상승                 │
  ├──────┼───────────┼─────────┼───────┼───────┼───────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────┤
  │ 5    │ alpha_026 │ +0.0543 │ +0.82 │ 80.7% │ -1 * ts_max(corr(ts_rank(vol,5), ts_rank(high,5), 5), 3)                                  │ 거래량-고가 랭크 상관: 최근 거래량과 고가 순위 상관이 낮으면 상승          │
  ├──────┼───────────┼─────────┼───────┼───────┼───────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────┤
  │ 6    │ alpha_032 │ +0.0512 │ +0.64 │ 70.9% │ scale(sma(close,7) - close) + 20*scale(corr(vwap, delay(close,5), 230))                   │ 평균회귀 + 장기 VWAP 상관: 7일 이평선 대비 저평가 + 장기 VWAP 상관         │
  ├──────┼───────────┼─────────┼───────┼───────┼───────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────┤
  │ 7    │ alpha_015 │ +0.0508 │ +0.80 │ 77.5% │ -1 * ts_sum(rank(corr(rank(high), rank(volume), 3)), 3)                                   │ 고가-거래량 상관 누적: 최근 3일 고가-거래량 상관 합이 낮으면 상승          │
  ├──────┼───────────┼─────────┼───────┼───────┼───────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────┤
  │ 8    │ alpha_100 │ -0.0470 │ -0.57 │ 29.5% │ indneutralize(-1 * rank(stddev(ret,5) - corr(ret,vol,5)) * rank(corr(ret,adv20,5)))       │ 섹터 중립 수익률 신호: 섹터 내 상대적 수익률 변동성 기반 (역방향)          │
  ├──────┼───────────┼─────────┼───────┼───────┼───────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────┤
  │ 9    │ alpha_013 │ +0.0443 │ +0.78 │ 77.7% │ -1 * rank(covariance(rank(close), rank(volume), 5))                                       │ 종가-거래량 공분산: 종가와 거래량이 동조하지 않으면 상승                   │
  ├──────┼───────────┼─────────┼───────┼───────┼───────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────┤
  │ 10   │ alpha_050 │ +0.0417 │ +0.68 │ 74.5% │ -1 * ts_max(rank(corr(rank(volume), rank(vwap), 5)), 5)                                   │ 거래량-VWAP 상관: 거래량과 VWAP 순위 상관이 낮으면 상승                    │
  ├──────┼───────────┼─────────┼───────┼───────┼───────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────┤
  │ 11   │ alpha_048 │ -0.0384 │ -0.38 │ 34.2% │ indneutralize(-1*ts_max(corr(rank(vwap), rank(volume), 3), 5))                            │ 섹터 중립 VWAP-거래량: 섹터 내 VWAP-거래량 상관 기반 (역방향)              │
  ├──────┼───────────┼─────────┼───────┼───────┼───────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────┤
  │ 12   │ alpha_094 │ -0.0357 │ -0.28 │ 36.0% │ -1 * rank(vwap - ts_min(vwap, 12)) ** ts_rank(corr(...), 3)                               │ VWAP 모멘텀: VWAP이 12일 저점 대비 높으면 하락 (역방향)                    │
  ├──────┼───────────┼─────────┼───────┼───────┼───────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────┤
  │ 13   │ alpha_055 │ +0.0339 │ +0.64 │ 74.9% │ -1 * corr(rank((close-ts_min(low,12))/(ts_max(high,12)-ts_min(low,12))), rank(volume), 6) │ 가격 위치-거래량 비동조: 12일 레인지 내 위치와 거래량이 음의 상관이면 상승 │
  ├──────┼───────────┼─────────┼───────┼───────┼───────────────────────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────┤
  │ 14   │ alpha_027 │ +0.0309 │ +0.62 │ 70.7% │ (rank(sma(corr(rank(volume), rank(vwap), 6), 2)) > 0.5) ? -1 : 1                          │ 거래량-VWAP 상관 이진: 상관이 낮으면 +1, 높으면 -1                         │
  └──────┴───────────┴─────────┴───────┴───────┴───────────────────────────────────────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────────────┘

| Rank | Alpha | Test IC | IC_IR | Hit% | 공식 | 의미 |
|------|-------|---------|-------|------|------|------|
| 1 | **alpha_042** | **-0.0625** | -0.60 | 25.4% | `rank(vwap - close) / rank(vwap + close)` | VWAP 이탈: 종가 > VWAP → 과매수 → 하락 (역방향) |
| 2 | **alpha_016** | **+0.0577** | +0.81 | 78.4% | `-1 * rank(cov(rank(high), rank(vol), 5))` | 고가-거래량 공분산: 비동조 시 상승 |
| 3 | **alpha_040** | **+0.0567** | +0.57 | 71.4% | `-1 * rank(std(high,10)) * corr(high,vol,10)` | 변동성 × 거래량 상관: 낮으면 상승 |
| 4 | **alpha_044** | **+0.0561** | +0.89 | 82.2% | `-1 * corr(high, rank(volume), 5)` | 고가-거래량 비동조: 고가↑ 거래량↓ → 상승 |
| 5 | **alpha_026** | **+0.0543** | +0.82 | 80.7% | `-1 * ts_max(corr(ts_rank(vol,5), ts_rank(high,5), 5), 3)` | 거래량-고가 랭크 상관 낮으면 상승 |
| 6 | **alpha_032** | **+0.0512** | +0.64 | 70.9% | `scale(sma(close,7)-close) + 20*scale(corr(vwap,delay(close,5),230))` | 평균회귀 + 장기 VWAP 상관 |
| 7 | **alpha_015** | **+0.0508** | +0.80 | 77.5% | `-1 * ts_sum(rank(corr(rank(high), rank(vol), 3)), 3)` | 고가-거래량 상관 누적 낮으면 상승 |
| 8 | **alpha_100** | **-0.0470** | -0.57 | 29.5% | `indneutralize(-1*rank(std(ret,5)-corr(ret,vol,5))*rank(corr(ret,adv20,5)))` | 섹터 중립 수익률 신호 (역방향) |
| 9 | **alpha_013** | **+0.0443** | +0.78 | 77.7% | `-1 * rank(cov(rank(close), rank(vol), 5))` | 종가-거래량 공분산 낮으면 상승 |
| 10 | **alpha_050** | **+0.0417** | +0.68 | 74.5% | `-1 * ts_max(rank(corr(rank(vol), rank(vwap), 5)), 5)` | 거래량-VWAP 상관 낮으면 상승 |
| 11 | **alpha_048** | **-0.0384** | -0.38 | 34.2% | `indneutralize(-1*ts_max(corr(rank(vwap), rank(vol), 3), 5))` | 섹터 중립 VWAP-거래량 (역방향) |
| 12 | **alpha_094** | **-0.0357** | -0.28 | 36.0% | `-1 * rank(vwap - ts_min(vwap, 12)) ** ts_rank(...)` | VWAP 모멘텀 (역방향) |
| 13 | **alpha_055** | **+0.0339** | +0.64 | 74.9% | `-1 * corr(rank(price_position), rank(vol), 6)` | 가격위치-거래량 비동조 시 상승 |
| 14 | **alpha_027** | **+0.0309** | +0.62 | 70.7% | `(rank(sma(corr(rank(vol), rank(vwap), 6), 2)) > 0.5) ? -1 : 1` | 거래량-VWAP 상관 이진 신호 |

### 핵심 패턴: 거래량-가격 비동조 (Volume-Price Divergence)

| 패턴 | 설명 | 해당 알파 |
|------|------|----------|
| 거래량↑ + 가격↓ | 세력 매집, 상승 신호 | alpha_016, 044, 026, 015, 013 |
| VWAP 이탈 | 종가 > VWAP → 과매수 → 하락 | alpha_042 (역방향) |
| 평균회귀 | 7일 이평선 대비 저평가 → 상승 | alpha_032 |
| 섹터 중립 | 섹터 내 상대 위치 기반 | alpha_100, 048 |

---

## 6. 백테스트 결과 (2024-01-01 ~ 2026-02-06)

### Long-Short 전략

| Alpha | Total | Annual | Sharpe | MDD | Win% | PF |
|-------|-------|--------|--------|-----|------|-----|
| **alpha_094** | **+164%** | **+22.4%** | **2.68** | -19% | 65% | 2.43 |
| alpha_026 | +67% | +6.2% | 1.24 | -26% | 60% | 1.57 |
| alpha_044 | +50% | +4.7% | 1.08 | -17% | 61% | 1.48 |
| alpha_016 | +50% | +4.7% | 0.94 | -20% | 58% | 1.41 |
| alpha_015 | +43% | +4.1% | 0.88 | -18% | 59% | 1.39 |
| alpha_042 | +50% | +4.2% | 0.74 | -36% | 60% | 1.33 |
| alpha_013 | +35% | +3.4% | 0.67 | -18% | 57% | 1.29 |

### Combined Strategy (alpha_044 + 016 + 026)

| Metric | Value |
|--------|-------|
| Total Return | **+107.7%** |
| Annual Return | **+8.9%** |
| Sharpe Ratio | **1.61** |
| Max Drawdown | -24.4% |
| Win Rate | 60.2% |
| Profit Factor | 1.75 |
| # Trades | 430 |

### Long-Only 전략 (Top 10% 매수)

| Alpha | Total | Annual | Sharpe | MDD |
|-------|-------|--------|--------|-----|
| **alpha_094** | **+1384%** | **+75.4%** | **3.76** | -46% |
| alpha_100 | +295% | +23.4% | 1.60 | -44% |
| alpha_042 | +350% | +16.7% | 1.28 | -51% |

---

## 7. IC vs 백테스트 성과 차이

### IC (Information Coefficient)란?

- 알파 신호와 미래 수익률 간의 상관계수 (Spearman)
- `IC = corr(오늘의 알파값, 5일 후 수익률)`

| IC 값 | 의미 |
|-------|------|
| +0.05 이상 | 강한 양의 예측력 |
| 0 근처 | 예측력 없음 |
| -0.05 이하 | 강한 음의 예측력 |

### IC 순위 vs 백테스트 순위 비교

| Alpha | Test IC | IC 순위 | Sharpe | 백테스트 순위 |
|-------|---------|---------|--------|---------------|
| alpha_042 | -0.0625 | 1위 | 0.74 | 6위 |
| alpha_016 | +0.0577 | 2위 | 0.94 | 4위 |
| alpha_044 | +0.0561 | 4위 | 1.08 | 3위 |
| **alpha_094** | **-0.0357** | **12위** | **2.68** | **1위** |

### 왜 alpha_094가 IC는 낮은데 수익은 1등?

```
IC = "전체 종목의 평균 예측력" 측정
백테스트 = "상위 10% 극단 종목의 실제 수익" 측정

alpha_094는 "극단값에서 특히 강한" 알파
- 평균적으로는 약한 신호 (IC -0.036)
- 하지만 Top/Bottom 10%에서는 강한 분별력
```

**교훈**: IC만으로 알파를 평가하면 안 됨. 백테스트 필수!

---

## 8. 권장 전략

```
1순위: alpha_094 단독 (Sharpe 2.68, 연 +22%)
       - VWAP 저점 근처 종목 매수
       - 평균회귀 전략

2순위: Combined Top 3 (Sharpe 1.61, 연 +9%)
       - alpha_044 + alpha_016 + alpha_026
       - 거래량-가격 비동조 기반
       - 리스크 분산
```

---

## 9. 장기 학습 vs 단기 조건: 어떤 것이 더 중요한가?

### 배경: 테스트 결과에서 발견한 패턴

```
우리의 실험 결과:
- Alpha101 (규칙 기반, 3~12일 조건): Sharpe 2.68
- LASPS 60일 학습 모델: 이보다 낮은 성과

결론: 단기 예측에서는 최근 조건이 장기 학습을 압도
```

### 동의하는 부분

**1. 단기 예측(5일)에서는 최근 조건이 압도적**

```
Alpha101 결과:
- 3~12일 윈도우의 단순 규칙 → Sharpe 2.68 달성
- 복잡한 딥러닝 모델보다 성능 우수
- 이유: 시장 효율성으로 장기 패턴은 이미 차익거래로 소멸
```

**2. 정보의 반감기가 짧다**

```
정보 가치 = f(시간)

┌─────────────┬──────────────────────────────┐
│   기간      │          가치                │
├─────────────┼──────────────────────────────┤
│   1~3일     │  매우 높음 (아직 반영 안 됨) │
│   3~10일    │  중간 (일부 반영)            │
│   10일+     │  거의 없음 (이미 가격 반영)  │
└─────────────┴──────────────────────────────┘
```

**3. 시장 레짐 변화**

- 2020년에 통한 패턴이 2024년엔 안 통함
- 장기 학습 = 구식 패턴 학습 위험
- 시장은 끊임없이 변화 → 적응형 규칙이 유리

### 반대하는 부분

**1. 예측 대상에 따라 다르다**

```
┌─────────────────┬─────────────────────────────────────┐
│    예측 기간    │             최적 접근법              │
├─────────────────┼─────────────────────────────────────┤
│  단기 (1~5일)   │  최근 조건 >>> 장기 학습  ✓         │
│  중기 (1~3개월) │  혼합 접근 필요                     │
│  장기 (1년+)    │  펀더멘탈 > 기술적 조건             │
└─────────────────┴─────────────────────────────────────┘
```

**2. "학습 불필요"는 아니고 "학습 방식"이 다름**

```
Alpha101도 결국:
- 30년간의 백테스트로 "발견된" 규칙 (사람이 학습)
- 최적 윈도우(3, 5, 12일)도 데이터에서 학습된 파라미터
- 차이점: 모델 학습 vs 사람 학습
```

### 실용적 결론

```
┌─────────────────────────────────────────────────────┐
│           5일 예측 전략 우선순위                     │
├─────────────────────────────────────────────────────┤
│  1순위: 최근 3~5일 조건 기반 규칙 (Alpha101)         │
│  2순위: 최근 20~60일 기술지표 (간단한 ML)            │
│  3순위: 장기 패턴 학습 (효과 의심)                   │
└─────────────────────────────────────────────────────┘
```

### 핵심 통찰

> **"주가 단기 예측에서 복잡한 장기 학습보다 단순한 최근 조건이 더 효과적이다"**

이는 **Occam's Razor**(단순함의 원칙)와 일치한다.

**시장에서 복잡한 모델이 단순한 규칙을 이기기 어려운 이유:**

1. **노이즈 대 신호 비율이 너무 높음** - 복잡한 모델은 노이즈를 학습
2. **시장 효율성** - 발견된 패턴은 빠르게 차익거래로 소멸
3. **레짐 변화** - 과거 패턴이 미래에 반복되지 않음
4. **과적합 위험** - 파라미터가 많을수록 과적합 확률 증가

```
복잡도 vs 성과 곡선:

성과 │      ╭─╮
     │    ╭╯   ╰╮
     │  ╭╯       ╲
     │ ╱          ╲
     │╱            ╲__________
     └────────────────────────→ 복잡도
        ↑
     최적점 = 단순한 규칙 (Alpha101)
```

---

## 10. 섹터 중립화 (Industry Neutralization) 상세 설명

### 문제: 섹터 효과가 알파를 오염시킴

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       섹터 효과 예시                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  2024년 1월: AI 붐으로 반도체 섹터 전체 +30% 상승                           │
│                                                                             │
│  ┌────────────────┐    ┌────────────────┐    ┌────────────────┐            │
│  │   삼성전자     │    │   SK하이닉스   │    │   한미반도체   │            │
│  │   VWAP +25%   │    │   VWAP +35%   │    │   VWAP +28%   │            │
│  └────────────────┘    └────────────────┘    └────────────────┘            │
│                                                                             │
│  문제: 세 종목 모두 VWAP 상승 → 알파 점수 비슷                              │
│        BUT 실제로는 SK하이닉스가 섹터 대비 더 강함!                         │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 해결: 섹터 평균을 빼서 순수한 종목 알파 추출

```python
# 섹터 중립화 (indneutralize) 공식
neutralized_value = 종목값 - 해당_섹터_평균값
```

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     섹터 중립화 후                                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  반도체 섹터 평균 VWAP 상승률: +29%                                         │
│                                                                             │
│  ┌────────────────┐    ┌────────────────┐    ┌────────────────┐            │
│  │   삼성전자     │    │   SK하이닉스   │    │   한미반도체   │            │
│  │   원본: +25%  │    │   원본: +35%  │    │   원본: +28%  │            │
│  │   중립화: -4% │    │   중립화: +6% │    │   중립화: -1% │            │
│  └────────────────┘    └────────────────┘    └────────────────┘            │
│                                                                             │
│  결과: SK하이닉스가 섹터 대비 +6% 초과 상승 → 진짜 강한 종목!               │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### alpha_094 vs alpha_044 비교

```
alpha_094 (섹터 필요):
─────────────────────
공식: rank(rank(ts_max(delta(indneutralize(vwap, industry), 3), 5))) ** ...
                              ↑
                    섹터 평균 VWAP을 빼줌
                              ↓
      "섹터 대비 VWAP 변화가 큰 종목" 찾기


alpha_044 (섹터 불필요):
─────────────────────
공식: -1 * correlation(high, rank(volume), 5)
                    ↑
         섹터 정보 사용 안 함
                              ↓
      "고가와 거래량의 상관관계" 만 봄
```

### 왜 섹터 중립화가 중요한가?

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    섹터 효과 제거의 장점                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  1. 시장/섹터 베타 제거                                                     │
│     ─────────────────────                                                   │
│     • 시장 전체 상승 시 모든 종목 상승 → 구별 불가                          │
│     • 섹터 중립화 → 섹터 효과 제거 → 순수 종목 알파만 추출                  │
│                                                                             │
│  2. 롱숏 전략 효율성 증가                                                   │
│     ─────────────────────                                                   │
│     • 같은 섹터 내에서 롱/숏 → 섹터 리스크 헷지                             │
│     • 예: 반도체 내 SK하이닉스 롱, 삼성전자 숏                              │
│           → 반도체 섹터 하락해도 상대 수익 가능                             │
│                                                                             │
│  3. 과적합 방지                                                             │
│     ─────────────────────                                                   │
│     • "AI 붐에 반도체 샀다" = 섹터 베팅 (알파 아님)                         │
│     • "섹터 내 가장 강한 종목 샀다" = 진짜 알파                             │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 실제 예시: alpha_070 분해

```python
alpha_070 = rank(rank(ts_max(delta(indneutralize(vwap, industry), 3), 5))) **
            ts_rank(correlation(close, adv50, 18), 18)
```

```
Step 1: indneutralize(vwap, industry)
────────────────────────────────────
삼성전자 VWAP: 75,000원
반도체 섹터 평균 VWAP: 72,000원
→ 중립화 값: 75,000 - 72,000 = +3,000원 (섹터 대비 비쌈)

Step 2: delta(..., 3)
────────────────────────────────────
3일 전 중립화 값: +2,000원
오늘 중립화 값: +3,000원
→ delta = +1,000원 (섹터 대비 더 비싸지는 중)

Step 3: ts_max(..., 5)
────────────────────────────────────
최근 5일 중 가장 큰 delta 값 선택
→ "섹터 대비 VWAP이 가장 많이 올랐던 순간"

Step 4: rank(rank(...))
────────────────────────────────────
전 종목 중 순위 계산 (이중 순위로 극단값 강조)
```

### 섹터 데이터가 없으면?

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    섹터 데이터 없을 때                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  indneutralize(vwap, industry) 계산 불가                                    │
│                    ↓                                                        │
│  해당 종목 알파값 = NaN                                                     │
│                    ↓                                                        │
│  백테스트에서 제외됨                                                        │
│                                                                             │
│  2022-2024 기간:                                                            │
│  • 섹터 데이터: 5~6개 종목만 있음                                           │
│  • 나머지 ~4000개: 알파 계산 불가                                           │
│  • 백테스트 최소 조건 (50개) 미달 → 테스트 실패                             │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 알파 유형별 비교

| 구분 | 섹터 알파 (094, 070) | 단순 알파 (044) |
|------|---------------------|-----------------|
| **섹터 데이터** | 필수 | 불필요 |
| **측정 대상** | 섹터 대비 상대 성과 | 절대적 가격-거래량 패턴 |
| **장점** | 시장 베타 제거, 순수 알파 | 데이터 의존성 낮음 |
| **단점** | 섹터 분류 필요 | 시장 효과 포함될 수 있음 |
| **적합한 상황** | 롱숏 헷지 펀드 | 단순 모멘텀 전략 |

### 데이터 가용성

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       알파별 데이터 현황                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  기간          alpha_094      alpha_070      alpha_044                      │
│  ─────────    ───────────    ───────────    ───────────                     │
│  2022-2024    평균 5개       평균 6개       평균 2,560개                    │
│               유효일 0일     유효일 0일     유효일 606일                    │
│                                                                             │
│  2024-2026    평균 1,688개   평균 1,894개   평균 3,396개                    │
│               유효일 247일   유효일 258일   유효일 466일                    │
│                                                                             │
│  → 섹터 알파는 2024년부터 사용 가능                                         │
│  → 단순 알파는 전 기간 사용 가능                                            │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 핵심 통찰: 모멘텀 알파의 자기 조절 (섹터 로테이션)

**질문**: 섹터 집중이 문제가 되지 않나? (예: 상위 10%가 모두 반도체)

**답변**: 모멘텀 기반 알파는 스스로 섹터 로테이션을 수행한다.

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    모멘텀 기반 알파의 자기 조절                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  2024년 1월 (반도체 상승기):                                                │
│  ───────────────────────────                                                │
│  • SK하이닉스 VWAP 상승 → 알파 점수 높음 → 매수 선정                        │
│  • 반도체 섹터 집중 → 수익                                                  │
│                                                                             │
│  2022년 (반도체 폭락기):                                                    │
│  ───────────────────────────                                                │
│  • SK하이닉스 VWAP 하락 → 알파 점수 낮음 → 매수 선정 안 됨!                 │
│  • 반도체 섹터 자동 제외 → 손실 회피                                        │
│                                                                             │
│  ═══════════════════════════════════════════════════════════════════════   │
│                                                                             │
│  모멘텀 알파 = 자동 섹터 로테이션                                           │
│  "오르는 섹터 매수, 내리는 섹터 회피"가 자동으로 작동                       │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

#### 시뮬레이션 예시: 2022년 반도체 폭락

```
┌──────────────┬────────────────────────┬─────────────────┐
│    시점      │   반도체 VWAP 변화     │   알파 점수     │
├──────────────┼────────────────────────┼─────────────────┤
│  1월 (고점)  │   +5% (상승)           │   높음 → 매수   │
│  3월         │   -3% (하락 시작)      │   낮아짐        │
│  6월         │   -10% (폭락)          │   매우 낮음     │
│  9월 (저점)  │   -2% (하락 둔화)      │   여전히 낮음   │
│  12월        │   +1% (반등 시작)      │   상승 시작     │
└──────────────┴────────────────────────┴─────────────────┘

폭락 기간 (3월~9월):
• 알파 점수 낮음 → 상위 10%에 포함 안 됨
• 대신 다른 섹터 (방어주, 에너지 등) 선정
• 반도체 손실 자연 회피!
```

#### 결론: 섹터 중립화 필요 여부

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         섹터 중립화 판단 기준                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  섹터 중립화가 필요한 경우:                                                 │
│  • "시장이 틀렸다"고 베팅하고 싶을 때 (역추세 전략)                         │
│  • 섹터 무관하게 순수 종목 알파만 원할 때                                   │
│  • 마켓 뉴트럴 헷지펀드 전략                                                │
│                                                                             │
│  섹터 중립화가 불필요한 경우:                                               │
│  • 모멘텀 기반 전략 (현재 Alpha101)                                         │
│  • "시장을 따라가는" 추세 전략                                              │
│  • 모멘텀 알파가 자동으로 섹터 로테이션 수행                                │
│                                                                             │
│  ═══════════════════════════════════════════════════════════════════════   │
│                                                                             │
│  핵심: 모멘텀 알파는 섹터 집중 리스크를 스스로 관리한다.                    │
│       핫한 섹터 → 모멘텀 높음 → 많이 선택 → 수익 극대화                     │
│       폭락 섹터 → 모멘텀 낮음 → 선택 안 됨 → 손실 회피                      │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 11. 5% 손절 백테스트 결과

### 손절 적용 효과 (2024-2026, 5일 보유)

| 알파 | 손절 없음 | 5% 손절 | Sharpe 개선 |
|------|-----------|---------|-------------|
| alpha_094 (반전) | Sharpe 2.68, MDD -19% | Sharpe 3.71, MDD -10% | +38% |
| alpha_070 | Sharpe 1.91, MDD -10% | Sharpe 3.76, MDD -6% | +97% |

### alpha_044 백테스트 (2022-2024, 5% 손절)

| 보유기간 | Sharpe | 총 수익률 | MDD | 손절 발동률 |
|----------|--------|-----------|-----|-------------|
| 5일 | **4.54** | +1,139% | -8.2% | 2.2% |
| 10일 | 2.94 | +3,831% | -13.9% | 5.5% |
| 20일 | 2.20 | +66,837% | -20.4% | 15.8% |
| 30일 | 1.63 | +272,960% | -22.1% | 23.4% |

### 최종 권장 전략

```
┌─────────────────────────────────────────────────────────────────┐
│                      권장 전략                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ✓ 알파:     alpha_044 (섹터 데이터 불필요, 안정적)             │
│  ✓ 보유:     5일                                                │
│  ✓ 손절:     -5%                                                │
│  ✓ 기대치:   Sharpe 3.5~4.5, MDD -8~10%                         │
│                                                                 │
│  대안:                                                          │
│  • 섹터 데이터 있으면 alpha_094 (반전) 또는 alpha_070 사용      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 12. 참고 자료

- 원본 논문: [101 Formulaic Alphas](https://arxiv.org/abs/1601.00991) (WorldQuant, 2015)
- 데이터 기간: 2015-01-02 ~ 2026-02-06 (2,874일)
- 종목 수: 4,226개 (한국 주식)
- 섹터: 26개 (pykrx 기준)
