# Alpha101 사용법 및 분석 결과 로그

## 1. Alpha101이란

WorldQuant의 101 Formulaic Alphas를 한국 주식시장에 적용한 시스템이다. 각 알파는 OHLCV 데이터로부터 계산되는 수치 시그널이며, 시그널이 높은(또는 낮은) 종목을 매수하여 수익을 추구한다.

- **원래 방향**: 알파값이 높은 종목 매수 (예: `alpha_010`)
- **역방향 (_rev)**: 알파값이 낮은 종목 매수 (예: `alpha_049_rev`)

## 2. 사용 방법

### 2.1 알파 계산

```python
from lasps.data.processors.alpha101 import Alpha101Calculator

# Wide-format DataFrame 준비 (index=날짜, columns=종목코드)
calc = Alpha101Calculator(
    open_=wide['open'],
    high=wide['high'],
    low=wide['low'],
    close=wide['close'],
    volume=wide['volume'],
)

# 특정 알파만 계산
alphas = calc.compute_batch([9, 10, 13, 17, 18, 31, 38, 45, 49, 83])

# 전체 알파 계산 (VWAP 불필요한 것만)
all_alphas = calc.compute_simple(skip_errors=True)
```

### 2.2 종목 선정 전략 3가지

#### A. 개별 알파 (Individual)
```
단일 알파 시그널 → 상위 Top 5 종목 매수
```
- 가장 단순한 방식
- 알파 하나에 의존하므로 분산 부족

#### B. 앙상블 (Ensemble)
```
10개 알파 각각 z-score 정규화 → 종목별 합산 → Top 5
```
- 알파 시그널의 크기(강도)까지 반영
- 극단적 z-score를 가진 알파에 끌려갈 위험

#### C. 투표 (Voting)
```
10개 알파 각각 Top 5 후보 추천 → 득표수 내림차순 → Top 5
```
- 순위 정보만 사용 (이상치에 강건)
- 다수 알파가 합의한 종목 = 신뢰도 높은 종목

### 2.3 시뮬레이션 설정

| 항목 | 값 |
|------|-----|
| 초기 자본 | 1억원 |
| 매수 수수료 | 0.015% |
| 매도 수수료 | 0.015% + 거래세 0.23% = 0.245% |
| 리밸런싱 | 5거래일 간격 |
| 종목 수 | 5개 (동일 비중) |
| 리밸런싱 방식 | 전량 매도 후 재매수 |

### 2.4 실행 명령어

```bash
# 2025 Top10 기반 시뮬레이션 (2025-02-20 ~ 2026-02-20)
python scripts/simulate_trading.py

# 2024 기준 Top10 선정 + 투표 시뮬레이션
python scripts/simulate_voting_2024.py
```

---

## 3. 분석 결과

### 3.1 2025년 기준 Top 10 알파 (평가기간: 2025-02-20 ~ 2026-02-20)

단순 수익률 기반 알파 순위 (수수료 미반영):

| 순위 | 알파 | 누적수익률 | 복리수익률 | 승률 |
|------|------|-----------|-----------|------|
| 1 | alpha_049_rev | +109.3% | +162.9% | 52.1% |
| 2 | alpha_083_rev | +107.8% | +115.1% | 47.9% |
| 3 | alpha_031_rev | +107.6% | +134.4% | 60.4% |
| 4 | alpha_038_rev | +102.0% | +105.9% | 47.9% |
| 5 | alpha_010 | +95.1% | +131.1% | 68.8% |
| 6 | alpha_013 | +93.8% | +97.3% | 52.1% |
| 7 | alpha_018 | +89.4% | +125.3% | 62.5% |
| 8 | alpha_045 | +86.4% | +128.9% | 68.8% |
| 9 | alpha_017 | +86.2% | +124.1% | 66.7% |
| 10 | alpha_009 | +85.9% | +114.4% | 66.7% |

### 3.2 2025 Top10으로 실전 시뮬레이션 (2025-02-20 ~ 2026-02-20)

수수료/거래세 반영, 1억원 시작:

| 전략 | 최종자산 | 수익률 | Sharpe | MDD | 승률 | vs KOSPI |
|------|---------|--------|--------|-----|------|---------|
| **투표** | **2억 2,275만** | **+122.8%** | 1.97 | -17.9% | 54.7% | **+3.9%** |
| alpha_045 | 2억 1,251만 | +112.5% | 2.98 | -12.9% | 38.0% | -6.3% |
| alpha_010 | 2억 732만 | +107.3% | 1.72 | -25.0% | 53.5% | -11.5% |
| alpha_017 | 2억 365만 | +103.6% | 2.05 | -12.2% | 54.3% | -15.2% |
| alpha_038_rev | 2억 61만 | +100.6% | 1.18 | -47.8% | 42.4% | -18.2% |
| alpha_049_rev | 2억 24만 | +100.2% | 1.82 | -20.7% | 50.2% | -18.6% |
| alpha_018 | 1억 9,775만 | +97.8% | 1.94 | -14.1% | 51.4% | -21.1% |
| alpha_009 | 1억 8,957만 | +89.6% | 1.55 | -27.0% | 52.7% | -29.3% |
| alpha_031_rev | 1억 6,928만 | +69.3% | 1.15 | -36.8% | 49.0% | -49.6% |
| 앙상블 | 1억 6,623만 | +66.2% | 1.17 | -42.3% | 53.9% | -52.6% |
| alpha_013 | 9,702만 | -3.0% | 0.11 | -36.4% | 48.2% | -121.8% |
| alpha_083_rev | 7,846만 | -21.5% | -0.29 | -46.3% | 42.0% | -140.4% |

- KOSPI 벤치마크: +118.9%
- **투표 전략만 KOSPI 대비 초과수익 달성** (+3.9%)

### 3.3 2025 Top10을 2024년에 적용 (Out-of-Sample)

2025년 데이터로 선정한 알파를 2024년에 그대로 적용:

| 지표 | 결과 |
|------|------|
| 총수익률 | **-35.7%** |
| Sharpe | -1.62 |
| MDD | -42.9% |
| KOSPI | -10.1% |
| 초과수익 | -25.6% |

**결론**: 2025년 최적 알파가 2024년에는 전혀 유효하지 않음 (과적합)

### 3.4 2024년 기준 Top 10 알파 (In-Sample)

2024년 데이터로 알파를 재선정한 결과:

| 순위 | 알파 | 누적수익률 | 복리수익률 | 승률 |
|------|------|-----------|-----------|------|
| 1 | alpha_051 | +60.9% | +51.3% | 40% |
| 2 | alpha_016 | +39.2% | +27.9% | 65% |
| 3 | alpha_085_rev | +37.2% | +41.5% | 57% |
| 4 | alpha_043 | +32.7% | +35.4% | 55% |
| 5 | alpha_019 | +29.4% | +21.8% | 50% |
| 6 | alpha_030 | +27.6% | +25.5% | 54% |
| 7 | alpha_083 | +25.5% | +19.4% | 54% |
| 8 | alpha_046_rev | +23.3% | +18.7% | 55% |
| 9 | alpha_055 | +22.4% | +21.4% | 48% |
| 10 | alpha_008_rev | +21.6% | +18.2% | 58% |

**2025 Top10과 겹치는 알파: 0개**

### 3.5 2024 Top10으로 투표 시뮬레이션 (In-Sample)

| 지표 | 2025 Top10 사용 | 2024 Top10 사용 |
|------|----------------|----------------|
| **총수익률** | -35.7% | **+25.7%** |
| Sharpe | -1.62 | +0.81 |
| MDD | -42.9% | -21.5% |
| 승률 | 48.1% | 51.9% |
| KOSPI | -10.1% | -10.1% |
| **초과수익** | -25.6% | **+35.8%** |

월별 수익률 (2024 Top10 투표):

| 월 | 수익률 | 자산 |
|----|--------|------|
| 2024-01 | +5.0% | 1억 503만 |
| 2024-02 | +4.8% | 1억 1,009만 |
| 2024-03 | +2.5% | 1억 1,287만 |
| 2024-04 | +4.2% | 1억 1,762만 |
| 2024-05 | -2.0% | 1억 1,523만 |
| 2024-06 | -1.6% | 1억 1,338만 |
| 2024-07 | -5.3% | 1억 734만 |
| 2024-08 | +20.1% | 1억 2,886만 |
| 2024-09 | +0.0% | 1억 2,890만 |
| 2024-10 | +1.8% | 1억 3,126만 |
| 2024-11 | +5.3% | 1억 3,823만 |
| 2024-12 | -9.1% | 1억 2,568만 |

---

## 4. 핵심 발견

### 4.1 투표 전략이 가장 안정적
- 앙상블 대비 투표가 일관되게 우수 (극단값에 강건)
- 개별 알파 중 최고(alpha_045)보다 Sharpe는 낮지만 MDD가 양호

### 4.2 알파의 유효기간은 짧다
- 2024 Top10과 2025 Top10이 **완전히 다른 알파** (겹침 0개)
- 과거 최적 알파를 미래에 그대로 적용하면 큰 손실 가능

### 4.3 실전 적용시 Rolling 방식 필요
- 고정 알파 선정 → 미래 편향/과적합 위험
- 직전 N개월 성과로 알파를 동적 선정하는 Adaptive 방식이 현실적
- 기존 `backtest_alpha_adaptive.py`가 이 접근을 구현

### 4.4 수수료 영향
- 5일 리밸런싱 × 전량 매도매수 → 회전율 약 48~51x/년
- 연간 수수료+거래세: 약 1,200~2,000만원 (초기자본의 12~20%)
- 리밸런싱 주기 늘리거나 부분 교체 전략으로 비용 절감 가능

---

## 5. 관련 파일

| 파일 | 설명 |
|------|------|
| `scripts/simulate_trading.py` | 3전략 시뮬레이션 (개별/앙상블/투표) |
| `scripts/simulate_voting_2024.py` | 2024 기준 알파 선정 + 투표 시뮬 |
| `scripts/evaluate_top_alphas_allstocks.py` | 전종목 알파 순위 평가 |
| `scripts/backtest_alpha_adaptive.py` | Adaptive 알파 선정 백테스트 |
| `lasps/data/processors/alpha101/calculator.py` | Alpha101 계산 엔진 |
| `data/simulation_results/simulation_summary.csv` | 12전략 성과 요약 |
| `data/simulation_results/daily_portfolio_values.csv` | 일별 포트폴리오 평가액 |
| `data/simulation_results/trade_log.csv` | 앙상블 매매기록 |
| `data/alpha_top10_allstocks.csv` | 2025 기준 전체 알파 순위 |

---

*최종 업데이트: 2026-02-25*
